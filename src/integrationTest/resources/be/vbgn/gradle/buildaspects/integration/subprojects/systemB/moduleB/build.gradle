subprojects {
    if (name == 'moduleB-systemVersion-1.0' || name == 'moduleB-systemVersion-2.0') {
        assert project.extensions.findByName("buildAspects") != null
        assert project.extensions.findByName("buildVariant") != null
    } else {
        assert project.extensions.findByName("buildAspects") == null
        assert project.extensions.findByName("buildVariant") == null
    }
}

buildAspects.withVariant("systemVersion", "1.0") {
    assert buildVariant.getProperty("systemVersion") == "1.0"
    try {
        buildVariant.systemVersion = "bla"
    } catch (ReadOnlyPropertyException _) {
        // No Op
    }
    assert buildVariant.getProperty("systemVersion") == "1.0"
}

buildAspects.withVariant("systemVersion", "2.0") {
    assert buildVariant.systemVersion == "2.0"
    try {
        assert buildVariant.nonexistingProperty != null, "Exception should have been thrown for nonexisting property"
        assert false, "Exception should have been thrown for nonexisting property"
    } catch (MissingPropertyException _) {

    }
}
